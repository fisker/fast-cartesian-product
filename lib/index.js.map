{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["function lengthAccumulator(accumulator, {length}) {\n  return accumulator * length\n}\n\nconst hasOwn = Object.prototype.hasOwnProperty\n\nfunction isValidSet(iterable) {\n  return getIterableLength(iterable) > 0\n}\n\nfunction hasLength(iterable) {\n  return hasOwn.call(iterable, 'length')\n}\n\nfunction breakableForEach(iterable, iteratee) {\n  if (hasLength(iterable)) {\n    const {length} = iterable\n    for (let i = 0; i < length; i += 1) {\n      const shouldContinue = iteratee(iterable[i], i, iterable)\n\n      if (shouldContinue === false) {\n        break\n      }\n    }\n\n    return\n  }\n\n  const iterator = iterable[Symbol.iterator]()\n\n  let index = 0\n  let {value, done} = iterator.next()\n  while (!done) {\n    const shouldContinue = iteratee(value, index, iterable)\n\n    if (shouldContinue === false) {\n      break\n    }\n\n    ;({value, done} = iterator.next())\n    index += 1\n  }\n}\n\nfunction getIterableElementByIndex(iterable, index) {\n  if (hasLength(iterable)) {\n    return iterable[index]\n  }\n\n  let element\n\n  breakableForEach(iterable, (value, currentIndex) => {\n    if (index === currentIndex) {\n      element = value\n      return false\n    }\n  })\n\n  return element\n}\n\nfunction getIterableLength(iterable) {\n  if (hasLength(iterable)) {\n    return iterable.length\n  }\n\n  // Set#size\n  if ('size' in iterable) {\n    return iterable.size\n  }\n\n  let length = 0\n\n  breakableForEach(iterable, () => (length += 1))\n\n  return length\n}\n\nclass FastCartesianProduct {\n  constructor(sets) {\n    if (!isValidSet(sets)) {\n      throw new Error('sets should not be empty')\n    }\n\n    breakableForEach(sets, subsets => {\n      if (!isValidSet(subsets)) {\n        throw new Error('sets should not have empty element')\n      }\n    })\n\n    this.sets = sets\n  }\n\n  get(index) {\n    const setsLength = getIterableLength(this.sets)\n    const set = new Array(setsLength)\n\n    let indexRemaining = index\n\n    for (let i = 0; i < setsLength; i += 1) {\n      const subSets = getIterableElementByIndex(this.sets, setsLength - i - 1)\n      const length = getIterableLength(subSets)\n      const index = indexRemaining % length\n      indexRemaining -= index\n      indexRemaining /= length\n      set[setsLength - i - 1] = getIterableElementByIndex(subSets, index)\n    }\n\n    return set\n  }\n\n  [Symbol.iterator]() {\n    const instance = this\n    const {size} = instance\n    let index = 0\n\n    return {\n      next() {\n        const done = index >= size\n        const value = instance.get(index)\n\n        index += 1\n\n        return {\n          value,\n          done,\n        }\n      },\n    }\n  }\n\n  get size() {\n    let size = 1\n    const setsLength = getIterableLength(this.sets)\n\n    breakableForEach(this.sets, subSets => {\n      const length = getIterableLength(subSets)\n      size *= length\n      // eslint-disable-next-line no-restricted-globals\n      if (!isFinite(size)) {\n        return false\n      }\n    })\n\n    return size\n  }\n}\n\nexport default FastCartesianProduct\n"],"names":["hasOwn","Object","prototype","hasOwnProperty","isValidSet","iterable","getIterableLength","hasLength","call","breakableForEach","iteratee","length","i","shouldContinue","iterator","Symbol","index","next","value","done","getIterableElementByIndex","element","currentIndex","size","FastCartesianProduct","sets","Error","subsets","setsLength","set","Array","indexRemaining","subSets","instance","get","isFinite"],"mappings":"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"}