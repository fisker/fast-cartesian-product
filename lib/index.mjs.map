{"version":3,"file":"index.mjs","sources":["../src/index.js"],"sourcesContent":["function lengthAccumulator(accumulator, {length}) {\n  return accumulator * length\n}\n\nconst hasOwn = Object.prototype.hasOwnProperty\n\nfunction isValidSet(iterable) {\n  return getIterableLength(iterable) > 0\n}\n\nfunction hasLength(iterable) {\n  return hasOwn.call(iterable, 'length')\n}\n\nfunction breakableForEach(iterable, iteratee) {\n  if (hasLength(iterable)) {\n    const {length} = iterable\n    for (let i = 0; i < length; i += 1) {\n      const shouldContinue = iteratee(iterable[i], i, iterable)\n\n      if (shouldContinue === false) {\n        break\n      }\n    }\n\n    return\n  }\n\n\n  const iterator = iterable[Symbol.iterator]()\n\n  let index = 0\n  let {value, done} = iterator.next()\n  while(!done) {\n    const shouldContinue = iteratee(value, index, iterable)\n\n    if (shouldContinue === false) {\n      break\n    }\n\n    ;({value, done} = iterator.next())\n    index ++\n  }\n}\n\nfunction getIterableElementByIndex(iterable, index) {\n  if (hasLength(iterable)) {\n    return iterable[index]\n  }\n\n  let element\n\n  breakableForEach(iterable, (value, currentIndex) => {\n    if (index === currentIndex) {\n      element = value\n      return false\n    }\n  })\n\n  return element\n}\n\nfunction getIterableLength(iterable) {\n  if (hasLength(iterable)) {\n    return iterable.length\n  }\n\n  // Set#size\n  if ('size' in iterable) {\n    return iterable.size\n  }\n\n  let length = 0\n\n  breakableForEach(iterable, () => length += 1)\n\n  return length\n}\n\nclass FastCartesianProduct {\n  constructor(sets) {\n    if (!isValidSet(sets)) {\n      throw new Error('sets should not be empty')\n    }\n\n    breakableForEach(sets, (subsets) => {\n      if (!isValidSet(subsets)) {\n        throw new Error('sets should not have empty element')\n      }\n    })\n\n    this.sets = sets\n  }\n\n  get(index) {\n    const setsLength = getIterableLength(this.sets)\n    const set = new Array(setsLength)\n\n    let indexRemaining = index\n\n    for (let i = setsLength - 1; i >= 0; i -= 1) {\n      const subSets = getIterableElementByIndex(this.sets, i)\n      const length = getIterableLength(subSets)\n      const index = indexRemaining % length\n      indexRemaining -= index\n      indexRemaining /= length\n      set[i] = getIterableElementByIndex(subSets, index)\n    }\n\n\n    return set\n  }\n\n  [Symbol.iterator]() {\n    const instance = this\n    const {size} = instance\n    let index = 0\n\n    return {\n      next() {\n        const done = index >= size\n        const value = instance.get(index)\n\n        index += 1\n\n        return {\n          value,\n          done,\n        }\n      },\n    }\n  }\n\n  get size() {\n    let size = 1\n    const setsLength = getIterableLength(this.sets)\n    for (let i = 0; i < setsLength; i += 1) {\n      const subSets = getIterableElementByIndex(this.sets, i)\n      const length = getIterableLength(subSets)\n      size *= length\n      if (!isFinite(size)) {\n        break\n      }\n    }\n\n    return size\n  }\n}\n\nexport default FastCartesianProduct\n"],"names":["hasOwn","Object","prototype","hasOwnProperty","isValidSet","iterable","getIterableLength","hasLength","call","breakableForEach","iteratee","length","i","shouldContinue","iterator","Symbol","index","next","value","done","getIterableElementByIndex","element","currentIndex","size","FastCartesianProduct","sets","Error","subsets","setsLength","set","Array","indexRemaining","subSets","instance","get","isFinite"],"mappings":"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"}